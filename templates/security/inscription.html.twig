{% extends 'base.html.twig' %}
{% block cssSpe %}
<link rel="stylesheet" href="{{ asset('/assets/css/spiner.css') }}">
<link rel="stylesheet" href="{{ asset('/assets/css/googleLogin.css') }}">
{% endblock %}
{% block body %}
<div class="simple-page ftco-degree-bg"></div>
<section class="ftco-section ftco-no-pt bg-light">
	<div class="container">
		<div class="row justify-content-center">
			<div class="col-3"></div>
			<div class="col-sm-6" id="back" style="z-index: 20; top: -100px;">
			</div>
			<div class="col-3"></div>
			<div class="col-sm-6">
				<div class="row justify-content-center">
					<h3 class="col-12">
						Connexion Client
					</h3>
					<form class="col-12">
						<div class="form-group">
							<input type="email" class="form-control" style="border: 1px solid #e6e6e6; width: 92%;"
								id="reg_email" aria-describedby="emailHelp" placeholder="Email" required>
						</div>
						<div class="form-group">
							<input type="password" class="form-control" style="border: 1px solid #e6e6e6; width: 92%;"
								id="reg_password" placeholder="Mot de passe" required>
						</div>
						<input type="hidden" name="token" value="{{ csrf_token('delete-item') }}" />
						<button type="submit" class="simple-button" style="width: 92% !important;">Connexion</button>
						<div class="form-check">
							<input type="checkbox" class="form-check-input" id="exampleCheck1">
							<label class="form-check-label" for="exampleCheck1">Rester connecté</label>
						</div>
						<a href="">Mot de passe oublié?</a>
					</form>
				</div>
			</div>
			<div class="col-sm-6">
				<div class="row justify-content-center">
					<h3 class="col-12">
						Nouveau sur Bikeloc ?
					</h3>
					<form class="col-12" id="inscription">
						<div class="form-group">
							<input type="text" class="form-control" style="border: 1px solid #e6e6e6; width: 92%;"
								name="prenom" id="prenom" aria-describedby="emailHelp" placeholder="Prénom" required>
						</div>
						<div class="form-group">
							<input type="text" class="form-control" style="border: 1px solid #e6e6e6; width: 92%;"
								name="nom" id="nom" placeholder="Nom de famille" required>
						</div>
						<div class="form-group">
							<input type="text" class="form-control" style="border: 1px solid #e6e6e6; width: 92%;"
								name="telephone" id="telephone" placeholder="Numéro de téléphone" required>
						</div>
						<div class="form-group">
							<input type="text" class="form-control" style="border: 1px solid #e6e6e6; width: 92%;"
								placeholder="Adresse email" name="email" id="email" required>
						</div>
						<div class="form-group">
							<input type="text" class="form-control" style="border: 1px solid #e6e6e6; width: 92%;"
								placeholder="Mot de passe" name="password" id="password" required>
						</div>
						<div class="form-group">
							<input type="text" class="form-control" style="border: 1px solid #e6e6e6; width: 92%;"
								placeholder="Confirmez votre mot de passe" name="ConfirmePassword" id="ConfirmePassword"
								required>
						</div>
						<div class="row" id="spiner">
						</div>
						<input type="hidden" name="token" value="{{ csrf_token('delete-item') }}" />
						<div id="button-inscription"><button type="submit" style="width: 92% !important;"
								class="simple-button" onclick="checkForm(event)">S'enregistrer</button></div>

					</form>
				</div>
			</div>
			<div class="col-12">
				<div class="row justify-content-center">
					<div class="col-12 erudit-space"></div>
					<div class="col-3"></div>
					<h1 style="text-align: center;" class="col-6">Ou avec</h1>
					<div class="col-3"></div>
					<div class="col-12 erudit-space"></div>
					<div class="col-4"></div>
					<a class="auth-provider google-login col-4" href="https://accounts.google.com/o/oauth2/v2/auth?scope=email&state=utile_pour_eviter_les_failles_csrf&redirect_uri=http://127.0.0.1:8000/inscription&response_type=code&client_id=338533409329-qilrbipceigee7lokapbrjqdljob01mi.apps.googleusercontent.com">
						<svg aria-hidden="true" class="svg-icon" width="18" height="18" viewBox="0 0 18 18">
							<g>
								<path
									d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18z"
									fill="#4285F4"></path>
								<path
									d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 0 1-7.18-2.54H1.83v2.07A8 8 0 0 0 8.98 17z"
									fill="#34A853"></path>
								<path d="M4.5 10.52a4.8 4.8 0 0 1 0-3.04V5.41H1.83a8 8 0 0 0 0 7.18l2.67-2.07z"
									fill="#FBBC05"></path>
								<path
									d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.4L4.5 7.49a4.77 4.77 0 0 1 4.48-3.3z"
									fill="#EA4335"></path>
							</g>
						</svg>
						Google
					</a>
					<div class="col-4"></div>
					<div class="col-4"></div>
					<div class="auth-provider facebook-login col-4">
						<svg aria-hidden="true" class="svg-icon" width="18" height="18" viewBox="0 0 18 18">
							<path
								d="M1.88 1C1.4 1 1 1.4 1 1.88v14.24c0 .48.4.88.88.88h7.67v-6.2H7.46V8.4h2.09V6.61c0-2.07 1.26-3.2 3.1-3.2.88 0 1.64.07 1.87.1v2.16h-1.29c-1 0-1.19.48-1.19 1.18V8.4h2.39l-.31 2.42h-2.08V17h4.08c.48 0 .88-.4.88-.88V1.88c0-.48-.4-.88-.88-.88H1.88z"
								fill="#fff"></path>
						</svg>
						Facebook
					</div>
					<div class="col-4"></div>
					<!-- <div class="col-4"></div>
					<div class="auth-provider kyber-login col-4">
						<svg aria-hidden="true" class="svg-icon" width="27" height="27" viewBox="0 0 27 27">
							<g>
								<path
									d=" M 12.392 11.613 L 20.585 20.225 L 12.587 27 L 12.392 11.612 L 12.392 11.613 Z  M 12.782 11.032 L 20.877 6.968 L 20.585 19.354 L 12.782 11.032 Z  M 12.294 10.354 L 12.294 0 L 20.78 6.387 L 12.294 10.354 Z  M 11.709 0.29 L 12.002 26.323 L 7.515 20.032 L 6.15 6.581 L 11.709 0.29 Z "
									fill="#fff" />
							</g>
						</svg>
						Log in with Kyber
					</div>
					<div class="col-4"></div> -->
				</div>
			</div>
		</div>
	</div>
</section>

{% endblock %}

{% block java %}
<script>
	function checkForm(ev) {
		ev.preventDefault();
		var erreur = false;
		var x = document.getElementById("prenom");
		if (document.getElementById("prenom").value == "") {
			erreur = true;
			document.getElementById("prenom").style.borderColor = "#fd0000"
		} else {
			document.getElementById("prenom").style.borderColor = "#e6e6e6"
		}
		if (document.getElementById("nom").value.trim() == "") {
			erreur = true;
			document.getElementById("nom").style.borderColor = "#fd0000"
		} else {
			document.getElementById("nom").style.borderColor = "#e6e6e6"
		}
		if (document.getElementById("telephone").value.trim() == "") {
			erreur = true;
			document.getElementById("telephone").style.borderColor = "#fd0000"
		} else {
			document.getElementById("telephone").style.borderColor = "#e6e6e6"
		}
		if (document.getElementById("email").value.trim() == "") {
			erreur = true;
			document.getElementById("email").style.borderColor = "#fd0000"
		} else {
			document.getElementById("email").style.borderColor = "#e6e6e6"
		}
		if (document.getElementById("password").value.trim() == "") {
			erreur = true;
			document.getElementById("password").style.borderColor = "#fd0000"
		} else {
			document.getElementById("password").style.borderColor = "#e6e6e6"
		}
		if (document.getElementById("ConfirmePassword").value.trim() == "") {
			erreur = true;
			document.getElementById("ConfirmePassword").style.borderColor = "#fd0000"
		} else {
			document.getElementById("ConfirmePassword").style.borderColor = "#e6e6e6"
		}
		if (erreur) {
			document.getElementById("back").innerHTML = "<div class='position-fixed alert alert-warning' id='alert' role='alert'><strong>Attention !</strong> Les champs rouges sont obligatoires !</div>";
			window.setTimeout(function () {
				$(".alert").fadeTo(500, 0).slideUp(500, function () {
					$(this).remove();
				});
			}, 3000);
		} else {
			inscription(ev);
		}
	}
	function inscription(ev) {
		ev.preventDefault();
		document.getElementById("spiner").innerHTML = "<div class='col-3'></div>" +
			"<div class='col-sm-6'>" +
			"<div class='item'>" +
			"<div id='dot6' class='dot'></div>" +
			"<div id='dot7' class='dot'></div>" +
			"<div id='dot8' class='dot'></div>" +
			"<div id='dot9' class='dot'></div>" +
			"<div id='dot10' class='dot'></div>" +
			"</div>" +
			"</div>" +
			"<div class='col-3'></div>";
		document.getElementById("button-inscription").innerHTML = "";
		var myForm = document.getElementById('inscription');
		formData = new FormData(myForm);
		var object = {};
		formData.forEach((value, key) => object[key] = value);
		var formData = JSON.stringify(object);
		var param = JSON.stringify({
			x: {
				'form': formData
			}
		});
		$.ajax({
			type: "POST",
			url: "{{ path('inscriptionUser') }}",
			dataType: 'json',
			data: {
				PARAM: param
			},
			success: function (retour) {
				var retour = JSON.parse(retour);
				document.getElementById("spiner").innerHTML = "";
				if (retour.code == 2) {
					retour.data.forEach(element => {
						document.getElementById(element).style.borderColor = "#fd0000"
					});
				}
				document.getElementById("button-inscription").innerHTML = "<button type='submit' style='width: 92% !important;' class='simple-button' onclick='checkForm(event)'>S'enregistrer</button>";
				document.getElementById("back").innerHTML = "<div class='position-fixed alert alert-" + arrayInfo[retour
					.code] + "' id='alert' role='alert'><strong>" + arrayMsg[retour.code] +
					"!</strong> " + retour.message + "!</div>";
				window.setTimeout(function () {
					$(".alert").fadeTo(500, 0).slideUp(500, function () {
						$(this).remove();
					});
				}, 3000);
			}
		});
	}
</script>
{% endblock %}